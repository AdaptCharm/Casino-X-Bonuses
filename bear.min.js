var activeElement,curEmailIndex,curTextIndex,screenCenter,svgCoords,emailCoords,emailScrollMax,dFromC,blinking,eyeLCoords,eyeRCoords,noseCoords,mouthCoords,eyeLAngle,eyeLX,eyeLY,eyeRAngle,eyeRX,eyeRY,noseAngle,noseX,noseY,mouthAngle,mouthX,mouthY,mouthR,chinX,chinY,chinS,faceX,faceY,faceSkew,eyebrowSkew,outerEarX,outerEarY,hairX,hairS,elements=document.getElementsByClassName("form-control"),confirmEmailLabel=document.querySelector("#confirmEmailLabel"),confirmEmail=document.querySelector("#confirmEmail"),passwordLabel=document.querySelector("#passwordLabel"),password=document.querySelector("#password"),confirmPasswordLabel=document.querySelector("#confirmPasswordLabel"),confirmPassword=document.querySelector("#confirmPassword"),showPasswordCheck=document.querySelector("#showPasswordCheck"),showPasswordToggle=document.querySelector("#showPasswordToggle"),mySVG=document.querySelector(".svgContainer"),twoFingers=document.querySelector(".twoFingers"),armL=document.querySelector(".armL"),armR=document.querySelector(".armR"),eyeL=document.querySelector(".eyeL"),eyeR=document.querySelector(".eyeR"),nose=document.querySelector(".nose"),mouth=document.querySelector(".mouth"),mouthBG=document.querySelector(".mouthBG"),mouthSmallBG=document.querySelector(".mouthSmallBG"),mouthMediumBG=document.querySelector(".mouthMediumBG"),mouthLargeBG=document.querySelector(".mouthLargeBG"),mouthMaskPath=document.querySelector("#mouthMaskPath"),mouthOutline=document.querySelector(".mouthOutline"),tooth=document.querySelector(".tooth"),tongue=document.querySelector(".tongue"),chin=document.querySelector(".chin"),face=document.querySelector(".face"),eyebrow=document.querySelector(".eyebrow"),outerEarL=document.querySelector(".earL .outerEar"),outerEarR=document.querySelector(".earR .outerEar"),earHairL=document.querySelector(".earL .earHair"),earHairR=document.querySelector(".earR .earHair"),hair=document.querySelector(".hair"),bodyBG=document.querySelector(".bodyBGnormal"),bodyBGchanged=document.querySelector(".bodyBGchanged"),chinMin=.5,mouthStatus="small",eyeScale=1,eyesCovered=!1,showPasswordClicked=!1;function calculateFaceMove(e){var o=email.selectionEnd,t=document.createElement("div"),a=document.createElement("span"),n=getComputedStyle(email),s={};null!=o&&0!=o||(o=email.value.length),[].forEach.call(n,function(e){t.style[e]=n[e]}),t.style.position="absolute",document.body.appendChild(t),t.textContent=email.value.substr(0,o),a.textContent=email.value.substr(o)||".",t.appendChild(a),email.scrollWidth<=emailScrollMax?(s=getPosition(a),dFromC=screenCenter-(s.x+emailCoords.x),eyeLAngle=getAngle(eyeLCoords.x,eyeLCoords.y,emailCoords.x+s.x,emailCoords.y+25),eyeRAngle=getAngle(eyeRCoords.x,eyeRCoords.y,emailCoords.x+s.x,emailCoords.y+25),noseAngle=getAngle(noseCoords.x,noseCoords.y,emailCoords.x+s.x,emailCoords.y+25),mouthAngle=getAngle(mouthCoords.x,mouthCoords.y,emailCoords.x+s.x,emailCoords.y+25)):(eyeLAngle=getAngle(eyeLCoords.x,eyeLCoords.y,emailCoords.x+emailScrollMax,emailCoords.y+25),eyeRAngle=getAngle(eyeRCoords.x,eyeRCoords.y,emailCoords.x+emailScrollMax,emailCoords.y+25),noseAngle=getAngle(noseCoords.x,noseCoords.y,emailCoords.x+emailScrollMax,emailCoords.y+25),mouthAngle=getAngle(mouthCoords.x,mouthCoords.y,emailCoords.x+emailScrollMax,emailCoords.y+25)),eyeLX=20*Math.cos(eyeLAngle),eyeLY=10*Math.sin(eyeLAngle),eyeRX=20*Math.cos(eyeRAngle),eyeRY=10*Math.sin(eyeRAngle),noseX=23*Math.cos(noseAngle),noseY=10*Math.sin(noseAngle),mouthX=23*Math.cos(mouthAngle),mouthY=10*Math.sin(mouthAngle),mouthR=6*Math.cos(mouthAngle),chinX=.8*mouthX,chinY=.5*mouthY,(chinS=1-.15*dFromC/100)>1&&(chinS=1-(chinS-1))<chinMin&&(chinS=chinMin),faceX=.3*mouthX,faceY=.4*mouthY,faceSkew=5*Math.cos(mouthAngle),eyebrowSkew=25*Math.cos(mouthAngle),outerEarX=4*Math.cos(mouthAngle),outerEarY=5*Math.cos(mouthAngle),hairX=6*Math.cos(mouthAngle),hairS=1.2,TweenMax.to(eyeL,1,{x:-eyeLX,y:-eyeLY,ease:Expo.easeOut}),TweenMax.to(eyeR,1,{x:-eyeRX,y:-eyeRY,ease:Expo.easeOut}),TweenMax.to(nose,1,{x:-noseX,y:-noseY,rotation:mouthR,transformOrigin:"center center",ease:Expo.easeOut}),TweenMax.to(mouth,1,{x:-mouthX,y:-mouthY,rotation:mouthR,transformOrigin:"center center",ease:Expo.easeOut}),TweenMax.to(chin,1,{x:-chinX,y:-chinY,scaleY:chinS,ease:Expo.easeOut}),TweenMax.to(face,1,{x:-faceX,y:-faceY,skewX:-faceSkew,transformOrigin:"center top",ease:Expo.easeOut}),TweenMax.to(eyebrow,1,{x:-faceX,y:-faceY,skewX:-eyebrowSkew,transformOrigin:"center top",ease:Expo.easeOut}),TweenMax.to(outerEarL,1,{x:outerEarX,y:-outerEarY,ease:Expo.easeOut}),TweenMax.to(outerEarR,1,{x:outerEarX,y:outerEarY,ease:Expo.easeOut}),TweenMax.to(earHairL,1,{x:-outerEarX,y:-outerEarY,ease:Expo.easeOut}),TweenMax.to(earHairR,1,{x:-outerEarX,y:outerEarY,ease:Expo.easeOut}),TweenMax.to(hair,1,{x:hairX,scaleY:hairS,transformOrigin:"center bottom",ease:Expo.easeOut}),document.body.removeChild(t)}function onTextInput(e){calculateFaceMove(e);for(var o="",t=0;t<elements.length;t++)o+=elements[t].value;var a=o;(curTextIndex=a.length)>0?("small"==mouthStatus&&(mouthStatus="medium",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,shapeIndex:8,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut}),eyeScale=.85),a.includes(" ")?(mouthStatus="large",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthLargeBG,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:3,y:-2,ease:Expo.easeOut}),TweenMax.to(tongue,1,{y:2,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.65,scaleY:.65,ease:Expo.easeOut,transformOrigin:"center center"}),eyeScale=.65):(mouthStatus="medium",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut}),eyeScale=.85)):(mouthStatus="small",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthSmallBG,shapeIndex:9,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{y:0,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:1,scaleY:1,ease:Expo.easeOut}),eyeScale=1)}function onEmailInput(e){calculateFaceMove(e);var o=email.value;curEmailIndex=o.length,console.log(o+curTextIndex),curEmailIndex>0?("small"==mouthStatus&&(mouthStatus="medium",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,shapeIndex:8,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut}),eyeScale=.85),o.includes("@")?(mouthStatus="large",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthLargeBG,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:3,y:-2,ease:Expo.easeOut}),TweenMax.to(tongue,1,{y:2,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.65,scaleY:.65,ease:Expo.easeOut,transformOrigin:"center center"}),eyeScale=.65):(mouthStatus="medium",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthMediumBG,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{x:0,y:1,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:.85,scaleY:.85,ease:Expo.easeOut}),eyeScale=.85)):(mouthStatus="small",TweenMax.to([mouthBG,mouthOutline,mouthMaskPath],1,{morphSVG:mouthSmallBG,shapeIndex:9,ease:Expo.easeOut}),TweenMax.to(tooth,1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(tongue,1,{y:0,ease:Expo.easeOut}),TweenMax.to([eyeL,eyeR],1,{scaleX:1,scaleY:1,ease:Expo.easeOut}),eyeScale=1)}function onTextFocus(e){activeElement="text",e.target.parentElement.classList.add("focusWithText"),onTextInput()}function onTextBlur(e){activeElement=null,setTimeout(function(){"text"==activeElement||(""==e.target.value&&e.target.parentElement.classList.remove("focusWithText"),resetFace())},100)}function onTextLabelClick(e){activeElement="text"}function onEmailFocus(e){activeElement="email",e.target.parentElement.classList.add("focusWithText"),onEmailInput()}function onEmailBlur(e){activeElement=null,setTimeout(function(){"email"==activeElement||(""==e.target.value&&e.target.parentElement.classList.remove("focusWithText"),resetFace())},100)}function onEmailLabelClick(e){activeElement="email"}function onPasswordFocus(e){activeElement="password",eyesCovered||coverEyes()}function onPasswordBlur(e){activeElement=null,setTimeout(function(){"toggle"==activeElement||"password"==activeElement||uncoverEyes()},100)}function onPasswordToggleFocus(e){activeElement="toggle",eyesCovered||coverEyes()}function onPasswordToggleBlur(e){activeElement=null,showPasswordClicked||setTimeout(function(){"password"==activeElement||"toggle"==activeElement||uncoverEyes()},100)}function onPasswordToggleMouseDown(e){showPasswordClicked=!0}function onPasswordToggleMouseUp(e){showPasswordClicked=!1}function onPasswordToggleChange(e){setTimeout(function(){e.target.checked?(password.type="text",spreadFingers()):(password.type="password",closeFingers())},100)}function onPasswordToggleClick(e){e.target.focus()}function spreadFingers(){TweenMax.to(twoFingers,.35,{transformOrigin:"bottom left",rotation:30,x:-9,y:-2,ease:Power2.easeInOut})}function closeFingers(){TweenMax.to(twoFingers,.35,{transformOrigin:"bottom left",rotation:0,x:0,y:0,ease:Power2.easeInOut})}function coverEyes(){TweenMax.killTweensOf([armL,armR]),TweenMax.set([armL,armR],{visibility:"visible"}),TweenMax.to(armL,.45,{x:-93,y:10,rotation:0,ease:Quad.easeOut}),TweenMax.to(armR,.45,{x:-93,y:10,rotation:0,ease:Quad.easeOut,delay:.1}),TweenMax.to(bodyBG,.45,{morphSVG:bodyBGchanged,ease:Quad.easeOut}),eyesCovered=!0}function uncoverEyes(){TweenMax.killTweensOf([armL,armR]),TweenMax.to(armL,1.35,{y:220,ease:Quad.easeOut}),TweenMax.to(armL,1.35,{rotation:105,ease:Quad.easeOut,delay:.1}),TweenMax.to(armR,1.35,{y:220,ease:Quad.easeOut}),TweenMax.to(armR,1.35,{rotation:-105,ease:Quad.easeOut,delay:.1,onComplete:function(){TweenMax.set([armL,armR],{visibility:"hidden"})}}),TweenMax.to(bodyBG,.45,{morphSVG:bodyBG,ease:Quad.easeOut}),eyesCovered=!1}function resetFace(){TweenMax.to([eyeL,eyeR],1,{x:0,y:0,ease:Expo.easeOut}),TweenMax.to(nose,1,{x:0,y:0,scaleX:1,scaleY:1,ease:Expo.easeOut}),TweenMax.to(mouth,1,{x:0,y:0,rotation:0,ease:Expo.easeOut}),TweenMax.to(chin,1,{x:0,y:0,scaleY:1,ease:Expo.easeOut}),TweenMax.to([face,eyebrow],1,{x:0,y:0,skewX:0,ease:Expo.easeOut}),TweenMax.to([outerEarL,outerEarR,earHairL,earHairR,hair],1,{x:0,y:0,scaleY:1,ease:Expo.easeOut})}function startBlinking(e){e=e?getRandomInt(e):1,blinking=TweenMax.to([eyeL,eyeR],.1,{delay:e,scaleY:0,yoyo:!0,repeat:1,transformOrigin:"center center",onComplete:function(){startBlinking(12)}})}function stopBlinking(){blinking.kill(),blinking=null,TweenMax.set([eyeL,eyeR],{scaleY:eyeScale})}function getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}function getAngle(e,o,t,a){return Math.atan2(o-a,e-t)}function getPosition(e){for(var o=0,t=0;e;){if("BODY"==e.tagName){var a=e.scrollLeft||document.documentElement.scrollLeft,n=e.scrollTop||document.documentElement.scrollTop;o+=e.offsetLeft-a+e.clientLeft,t+=e.offsetTop-n+e.clientTop}else o+=e.offsetLeft-e.scrollLeft+e.clientLeft,t+=e.offsetTop-e.scrollTop+e.clientTop;e=e.offsetParent}return{x:o,y:t}}function isMobileDevice(){var e,o=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(o=!0),o}function initLoginForm(){svgCoords=getPosition(mySVG),emailCoords=getPosition(email),screenCenter=svgCoords.x+mySVG.offsetWidth/2,eyeLCoords={x:svgCoords.x+84,y:svgCoords.y+76},eyeRCoords={x:svgCoords.x+113,y:svgCoords.y+76},noseCoords={x:svgCoords.x+97,y:svgCoords.y+81},mouthCoords={x:svgCoords.x+100,y:svgCoords.y+100};for(let e=0;e<elements.length;e++)elements[e].addEventListener("click",()=>{elements[e].addEventListener("focus",onTextFocus),elements[e].addEventListener("blur",onTextBlur),elements[e].addEventListener("input",onTextInput)});email.addEventListener("focus",onEmailFocus),email.addEventListener("blur",onEmailBlur),email.addEventListener("input",onEmailInput),emailLabel.addEventListener("click",onEmailLabelClick),password.addEventListener("focus",onPasswordFocus),password.addEventListener("blur",onPasswordBlur),confirmPassword.addEventListener("focus",onPasswordFocus),confirmPassword.addEventListener("blur",onPasswordBlur),showPasswordCheck.addEventListener("change",onPasswordToggleChange),showPasswordCheck.addEventListener("focus",onPasswordToggleFocus),showPasswordCheck.addEventListener("blur",onPasswordToggleBlur),showPasswordCheck.addEventListener("click",onPasswordToggleClick),showPasswordToggle.addEventListener("mouseup",onPasswordToggleMouseUp),showPasswordToggle.addEventListener("mousedown",onPasswordToggleMouseDown),TweenMax.set(armL,{x:-93,y:220,rotation:105,transformOrigin:"top left"}),TweenMax.set(armR,{x:-93,y:220,rotation:-105,transformOrigin:"top right"}),TweenMax.set(mouth,{transformOrigin:"center center"}),startBlinking(5),emailScrollMax=email.scrollWidth,isMobileDevice()&&(password.type="text",showPasswordCheck.checked=!0,TweenMax.set(twoFingers,{transformOrigin:"bottom left",rotation:30,x:-9,y:-2,ease:Power2.easeInOut})),console.clear()}initLoginForm();
